<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scroll Wall — Models, Influencers & Actors (Reddit)</title>
<style>
  :root{
    --bg:#0e1116; --bg2:#121722; --ink:#eef2f7; --muted:#a9b0bd;
    --accent:#ff6fa5; --accent2:#87d6ff; --polaroid:#161a24; --tape:#ffd3e0;
    --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:
    radial-gradient(1200px 600px at 20% -10%, #1b2233 0%, rgba(27,34,51,0) 60%),
    radial-gradient(800px 500px at 110% 10%, #13243a 0%, rgba(19,36,58,0) 55%),
    linear-gradient(#0b0e14,#0e1116 35%, #0d1118 100%);
    color:var(--ink);font:16px/1.45 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  h1{font-size:clamp(28px,5.8vw,46px);margin:22px 0 6px}
  .sub{color:var(--muted);font-weight:600;margin-bottom:18px}
  .wrap{max-width:1100px;margin:0 auto;padding:22px 18px 80px}
  .panel{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
    border:1px solid rgba(255,255,255,.06);border-radius:22px;padding:16px;display:flex;flex-wrap:wrap;gap:14px;align-items:center;box-shadow:var(--shadow)}
  .btn{appearance:none;border:0;cursor:pointer;background:linear-gradient(180deg,#ff98be,#ff6fa5);color:#121316;font-weight:800;letter-spacing:.2px;padding:12px 18px;border-radius:14px;box-shadow:0 8px 24px rgba(255,111,165,.35)}
  .count{font-weight:800;padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.1);color:var(--muted)}
  .toggle{display:flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid rgba(255,255,255,.08);border-radius:12px;background:rgba(255,255,255,.03);font-weight:700;color:var(--muted)}
  .field{flex:1 1 320px;display:flex;align-items:center;gap:10px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);padding:12px 14px;border-radius:14px;min-height:48px}
  .field label{color:var(--muted);font-weight:700}
  .field input{flex:1;min-width:120px;background:transparent;border:0;outline:0;color:var(--ink);font-weight:600}
  .grid{margin-top:16px;display:grid;gap:16px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
  .card{position:relative;background:var(--polaroid);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
  .card:before{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,.07),transparent 120px);pointer-events:none}
  .tape{position:absolute;left:22px;right:22px;top:10px;height:20px;background:repeating-linear-gradient(90deg,var(--tape),var(--tape) 10px,#ffc2d6 10px,#ffc2d6 20px);opacity:.7;filter:drop-shadow(0 6px 10px rgba(0,0,0,.35));transform:rotate(-.6deg);border-radius:3px}
  .thumb{width:100%;aspect-ratio:4/3;object-fit:cover;display:block;background:#0a0d14}
  .meta{padding:12px 14px 10px;display:flex;flex-direction:column;gap:8px}
  .title{font-weight:800;line-height:1.25}
  .subline{color:var(--muted);font-size:13px;display:flex;gap:12px;flex-wrap:wrap}
  .rate{display:flex;align-items:center;gap:6px;margin-top:2px}
  .star{cursor:pointer;font-size:20px;color:#7a8596}
  .star.on{color:#ffd86b;text-shadow:0 0 10px rgba(255,216,107,.35)}
  .perma{color:var(--accent2);font-weight:700}
  .err{margin-top:16px;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,104,104,.3);background:linear-gradient(180deg,rgba(255,104,104,.14),rgba(255,104,104,.08));color:#ffb6b6;font-weight:700;white-space:pre-wrap}
  .hide{display:none}
  .center{text-align:center;color:var(--muted);font-weight:700;margin-top:18px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Scroll Wall</h1>
    <div class="sub">SFW models • influencers • actors (Reddit). Rate with ⭐</div>

    <div class="panel">
      <button class="btn" id="loadBtn">Load more</button>
      <div class="count" id="count">0/0</div>
      <label class="toggle"><input type="checkbox" id="nsfw"> Allow NSFW</label>
      <div class="field" title="Use: reddit=r/Sub1,r/Sub2">
        <label for="override">Override:</label>
        <input id="override" placeholder="e.g. reddit=r/FashionModels,r/EmilyRatajkowski" />
      </div>
    </div>

    <div id="err" class="err hide"></div>
    <div id="grid" class="grid"></div>
    <div id="empty" class="center">Nothing yet — tap <b>Load more</b>.</div>
  </div>

<script>
/* ------------------------------ Config ------------------------------ */
const DEFAULT_SUBS = [
  'FashionModels','ModelPhotography','FashionPhotography','StreetFashion','Runway','Lookbook',
  'Beauty','MakeupAddiction','SkincareAddiction',
  'Celebs','ClassicCelebs','OldSchoolCool',
  'femalefashionadvice','malefashionadvice','Streetwear','fashion'
];

const PAGE_SIZE = 12;
const GRID = document.getElementById('grid');
const COUNT = document.getElementById('count');
const ERR   = document.getElementById('err');
const EMPTY = document.getElementById('empty');
const LOAD  = document.getElementById('loadBtn');
const NSFW  = document.getElementById('nsfw');
const OV    = document.getElementById('override');

let afterMap = {};
let shown = 0, fetched = 0;

/* ------------------------------ Helpers ------------------------------ */
const sleep = (ms)=>new Promise(r=>setTimeout(r,ms));
const shuffle = a=>{ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; };
const escapeHtml = s => (s||"").replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]));

function parseOverride(v){
  if(!v || !v.trim()) return null;
  const m = v.trim().match(/^reddit\s*=\s*(.+)$/i);
  if(!m) return null;
  return m[1].split(',').map(s=>s.trim().replace(/^r\//i,'')).filter(Boolean);
}
function pushErr(msg){ ERR.classList.remove('hide'); ERR.textContent = msg; }
function clearErr(){ ERR.classList.add('hide'); ERR.textContent=''; }
function updateCount(){ COUNT.textContent = `${shown}/${fetched}`; }

/* ------------------------------ Ratings ------------------------------ */
const RATE_KEY='scrollwall_ratings_v1';
const RATINGS = (()=>{ try{return JSON.parse(localStorage.getItem(RATE_KEY))||{}}catch{return {}} })();
const saveRatings = ()=> localStorage.setItem(RATE_KEY, JSON.stringify(RATINGS));

/* ------------------------------ Fetch ------------------------------ */
async function fetchFromSub(sub, allowNSFW){
  const after = afterMap[sub] ? `&after=${encodeURIComponent(afterMap[sub])}` : '';
  const url = `https://api.reddit.com/r/${sub}/top?t=week&limit=25${after}`;
  const items = [];

  const res = await fetch(url, {headers:{'Accept':'application/json'}});
  if(!res.ok) throw new Error(`HTTP ${res.status}`);
  const json = await res.json();
  afterMap[sub] = json?.data?.after || null;

  for(const c of (json?.data?.children ?? [])){
    const d = c.data; if(!d) continue;

    // NSFW filter toggled by checkbox:
    if (!allowNSFW && d.over_18) continue;

    let img = (d.preview?.images?.[0]?.source?.url) || d.url_overridden_by_dest || '';
    img = img.replace(/&amp;/g,'&');
    if(!/\.(jpe?g|png|gif|webp)$/i.test(img)) continue;

    items.push({
      id:d.id, title:d.title, author:d.author, subreddit:d.subreddit,
      score:d.score, permalink:`https://reddit.com${d.permalink}`, image:img, over18:d.over_18
    });
  }
  return items;
}

async function loadBatch(){
  clearErr();
  let subs = parseOverride(OV.value) || DEFAULT_SUBS.slice();
  subs = shuffle(subs).slice(0,6);

  const allowNSFW = NSFW.checked;
  const results = [];
  for(const sub of subs){
    try{
      const part = await fetchFromSub(sub, allowNSFW);
      results.push(...part);
    }catch(e){
      pushErr(`[${new Date().toLocaleTimeString()}] Error r/${sub}: ${e.message}`);
    }
    await sleep(120);
  }
  const final = shuffle(results).slice(0, PAGE_SIZE);
  fetched += final.length; render(final);
}

/* ------------------------------ Render ------------------------------ */
function star(id,n){ const on=(RATINGS[id]||0)>=n?'on':''; return `<span class="star ${on}" data-id="${id}" data-val="${n}">★</span>`; }
function card(it){
  const rated = RATINGS[it.id]||0;
  return `<article class="card" data-id="${it.id}">
    <span class="tape"></span>
    <img class="thumb" alt="${escapeHtml(it.title)}" loading="lazy" src="${it.image}">
    <div class="meta">
      <div class="title">${escapeHtml(it.title)}</div>
      <div class="subline"><span>${it.over18?'NSFW • ':''}r/${it.subreddit}</span> • <span>▲ ${it.score.toLocaleString()}</span> •
        <a class="perma" href="${it.permalink}" target="_blank" rel="noopener">permalink</a></div>
      <div class="rate" role="group">${star(it.id,1)}${star(it.id,2)}${star(it.id,3)}${star(it.id,4)}${star(it.id,5)}
        <span style="color:var(--muted);font-weight:700;margin-left:6px;">${rated?`${rated}/5`:'Tap to rate'}</span>
      </div>
    </div>
  </article>`;
}
function render(items){
  if(!items.length){ pushErr(`[${new Date().toLocaleTimeString()}] No fresh image posts found. Try Load more again or different subs.`); return; }
  GRID.insertAdjacentHTML('beforeend', items.map(card).join(''));
  shown += items.length; updateCount(); EMPTY.classList.add('hide');
}

GRID.addEventListener('click', e=>{
  const s = e.target.closest('.star'); if(!s) return;
  const id=s.dataset.id, val=+s.dataset.val; if(!id||!val) return;
  RATINGS[id]=val; saveRatings();
  const card = s.closest('.card');
  card.querySelectorAll('.star').forEach(el=>el.classList.toggle('on', +el.dataset.val<=val));
  const label = card.querySelector('.rate span:last-child'); if(label) label.textContent = `${val}/5`;
});

document.getElementById('loadBtn').addEventListener('click', loadBatch);

/* ------------------------------ Boot ------------------------------ */
updateCount();
</script>
</body>
</html>