<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scroll Wall • Models / Influencers / Actors</title>
<style>
/* --------- Theme --------- */
:root{
  --bg:#0d1117;
  --bg2:#0f1420;
  --panel:#1b2330;
  --ink:#e6edf3;
  --muted:#9aa5b1;
  --accent:#ff6ea9;      /* pink button */
  --accent-ink:#111;
  --ok:#31d0aa;          /* like green */
  --no:#ff5577;          /* dismiss red */
  --card:#121821;
  --ring: rgba(255,255,255,0.08);
  --glow: 0 12px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
  --radius: 18px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color:var(--ink); background:
    radial-gradient(1200px 500px at 50% -200px, #1a2330 0%, #0f1724 45%, #0d1117 100%);
}

header{
  position:sticky; top:0; z-index:5;
  background:linear-gradient(#0f1724, rgba(15,23,36,.6) 70%, transparent);
  backdrop-filter:saturate(120%) blur(6px);
  padding:20px 16px 10px; border-bottom:1px solid rgba(255,255,255,.06);
}
h1{ margin:0 0 6px; font-size:38px; letter-spacing:.5px }
.sub{ margin:0; color:var(--muted); font-weight:600; }

.controls{
  display:flex; gap:14px; align-items:center; flex-wrap:wrap;
  margin:14px 0 4px;
  padding:14px; border:1px solid var(--ring); background:var(--panel);
  border-radius:14px;
}

.btn{
  border:0; border-radius:14px; padding:16px 22px; font-weight:800;
  background:var(--accent); color:var(--accent-ink); cursor:pointer;
  box-shadow: var(--glow);
}
.counter{
  min-width:84px; text-align:center; padding:10px 14px; border-radius:12px;
  background:#0b1220; border:1px solid var(--ring); font-weight:800;
}
.switch{
  display:flex; align-items:center; gap:10px; margin-left:auto; white-space:nowrap;
}
.switch input{ width:48px; height:28px; appearance:none; background:#2a3342;
  border-radius:999px; position:relative; outline:none; cursor:pointer;
  box-shadow:inset 0 0 0 2px rgba(255,255,255,.06);
}
.switch input:checked{ background:#224637 }
.switch input:before{
  content:""; position:absolute; inset:4px auto 4px 4px; width:20px; border-radius:999px;
  background:white; transition:transform .18s ease;
}
.switch input:checked:before{ transform:translateX(20px) }

a.toplink{
  display:inline-flex; align-items:center; gap:10px;
  padding:10px 14px; border-radius:12px; border:1px solid var(--ring);
  background:var(--panel); text-decoration:none; color:var(--ink); font-weight:700;
}

/* override input */
#override{
  flex:1; min-width:260px; color:var(--ink); background:#0b1220; border:1px solid var(--ring);
  padding:14px 14px; border-radius:12px; outline:none;
}

/* --------- Cards grid --------- */
main{ padding:16px; }
.grid{
  display:grid; gap:16px; grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
}

/* card */
.card{
  position:relative; overflow:hidden; border-radius:var(--radius);
  background:var(--card); border:1px solid var(--ring); box-shadow:var(--glow);
  touch-action:none;  /* critical: stops page from scrolling during swipe */
}
.card figure{ margin:0; position:relative; aspect-ratio: 4 / 5; overflow:hidden; background:#0a0f17; }
.card img{
  width:100%; height:100%; object-fit:cover; display:block;
  transform:translateZ(0);
}

/* content */
.content{ padding:16px 16px 12px }
.title{ font-size:22px; font-weight:900; line-height:1.15; margin:0 0 6px }
.meta{ color:var(--muted); font-size:14px; margin:0 0 10px; }
.badges{ display:flex; gap:10px; }
.badge{
  padding:8px 12px; font-weight:800; border-radius:999px; border:1px solid var(--ring); background:rgba(255,255,255,.03);
}

/* bottom action bar */
.actions{
  position:absolute; inset:auto 12px 12px; display:flex; gap:10px;
}
.iconbtn{
  display:inline-flex; align-items:center; justify-content:center;
  width:52px; height:52px; border-radius:50%; border:1px solid var(--ring);
  background:rgba(255,255,255,.05); cursor:pointer; backdrop-filter: blur(2px);
}
.iconbtn svg{ pointer-events:none }

/* --------- Swipe animation & overlays --------- */
.card.swiping{ transition:none }
.card.like-anim{ animation:pop-like .45s ease both }
.card.dismiss-anim{ animation:pop-no .45s ease both }

@keyframes pop-like{
  0%{ transform:scale(.98) rotate(0deg) }
  40%{ transform:scale(1.02) rotate(-1deg) }
  100%{ transform:scale(1) }
}
@keyframes pop-no{
  0%{ transform:scale(1) }
  60%{ transform:scale(.96) }
  100%{ transform:scale(1) }
}

.overlay{
  position:absolute; inset:0; pointer-events:none; opacity:0;
  background: linear-gradient(to bottom, rgba(49,208,170,.18), transparent 60%);
  transition:opacity .15s ease;
}
.overlay.no{ background:linear-gradient(to bottom, rgba(255,85,119,.18), transparent 60%); }

/* rolling confetti hearts on like */
.confetti{
  position:absolute; inset:0; pointer-events:none; overflow:hidden;
}
.confetti i{
  position:absolute; width:14px; height:14px; background:var(--ok);
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 21s-6.716-4.317-9.193-6.794C.334 11.733.334 8.267 2.807 5.793a5.5 5.5 0 0 1 7.778 0L12 7.207l1.415-1.414a5.5 5.5 0 0 1 7.778 7.778C18.716 16.683 12 21 12 21z"/></svg>') center/contain no-repeat;
  animation: float 800ms ease-out forwards;
  opacity:.9;
}
@keyframes float{
  from{ transform: translate(var(--x,0), var(--y,0)) scale(.7) rotate(0deg); opacity:1 }
  to{ transform: translate(var(--xend,0), calc(var(--yend, -80px))) scale(1.1) rotate(35deg); opacity:0 }
}

/* tip */
.tip{ color:var(--muted); padding:14px 18px; border-radius:12px; border:1px dashed var(--ring); margin:16px 0; }

/* footer links */
.footerlinks{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:10px 0 0; }
.footerlinks a{ color:var(--ink); text-decoration:none }
.footerlinks .pill{ border:1px solid var(--ring); border-radius:999px; padding:8px 12px; }

/* small */
@media (max-width:520px){
  h1{ font-size:34px }
}
</style>
</head>
<body>
  <header>
    <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
      <div>
        <h1>Scroll Wall</h1>
        <p class="sub">Models • Influencers • Actors (Reddit). Rate with ⭐</p>
      </div>
      <a class="toplink" href="liked.html" title="Open liked posts">Liked ⭐</a>
    </div>

    <div class="controls">
      <button class="btn" id="loadMoreBtn">Load more</button>
      <div class="counter" id="count">0/0</div>

      <label class="switch" title="Allow NSFW">
        <input id="nsfw" type="checkbox">
        <span>Allow NSFW</span>
      </label>

      <input id="override" placeholder="e.g. reddit=r/FashionModels,r/Celebs,r/ModelPhotography" />
    </div>
    <div class="footerlinks">
      <span class="pill">Tip: swipe a card — right to ⭐ like, left to dismiss. Tap ⭐ to undo in Liked page.</span>
    </div>
  </header>

  <main>
    <div id="grid" class="grid"></div>
    <p id="empty" class="tip" style="display:none">No fresh image posts found. Try “Load more” again or different subs.</p>
  </main>

<script>
/* ---------------------- Config ---------------------- */
const DEFAULT_SUBS = [
  "Celebs", "ModelPhotography", "redcarpet", "OldSchoolCool",
  "FashionModels", "InstagramModels", "LadiesOfCinema",
  "BeautifulFemales", "CelebEvents", "Modelshoot"
];
// (You can type an override like: reddit=r/Celebs,r/FashionModels)

const STORAGE_LIKES = "likedPostsV1";
const loadedIds = new Set();        // avoid duplicates this session
let loaded = 0;
let total = 0;

/* ---------------------- Utils ---------------------- */
const $ = (sel, el=document) => el.querySelector(sel);
const h = (tag, cls) => {
  const el=document.createElement(tag); if(cls) el.className=cls; return el;
}
const decode = (s="") => s.replaceAll("&amp;","&").replaceAll("&lt;","<").replaceAll("&gt;",">");

/* pick best image from a Reddit post */
function pickImage(p){
  if (p?.preview?.images?.[0]?.source?.url){
    return decode(p.preview.images[0].source.url);
  }
  if (p?.url_overridden_by_dest && /\.(jpg|jpeg|png|gif)$/.test(p.url_overridden_by_dest)){
    return p.url_overridden_by_dest;
  }
  return null;
}

/* likes storage */
function getLikes(){ try{ return JSON.parse(localStorage.getItem(STORAGE_LIKES)||"[]"); }catch{ return [] } }
function setLikes(arr){ localStorage.setItem(STORAGE_LIKES, JSON.stringify(arr)); }
function addLike(item){
  const likes = getLikes();
  if (!likes.find(x=>x.id===item.id)){ likes.unshift(item); setLikes(likes); }
}

/* ---------------------- Fetch ---------------------- */
async function fetchSubredditChunk(sub, allowNSFW){
  const url = `https://www.reddit.com/r/${sub}/top.json?t=week&limit=50`;
  const r = await fetch(url, {headers:{'User-Agent':'ScrollWall/1.0'}});
  if (!r.ok) throw new Error(`HTTP ${r.status}`);
  const j = await r.json();
  const items = [];
  for (const c of j.data.children){
    const p = c.data;
    if (!allowNSFW && p.over_18) continue;
    const img = pickImage(p); if(!img) continue;
    items.push({
      id: p.id,
      title: p.title,
      img,
      author: p.author,
      sub: p.subreddit,
      permalink: `https://reddit.com${p.permalink}`,
      nsfw: !!p.over_18,
      created: p.created_utc
    });
  }
  return items;
}

async function loadMore(){
  const allowNSFW = $("#nsfw").checked;
  const override = $("#override").value.trim();
  let subs = DEFAULT_SUBS;
  if (override.startsWith("reddit=")){
    const list = override.slice("reddit=".length).split(",").map(s=>s.replace(/^r\//,"").trim()).filter(Boolean);
    if (list.length) subs = list;
  }
  $("#loadMoreBtn").disabled = true; $("#empty").style.display="none";

  let newItems = [];
  for (const sub of subs){
    try{
      const chunk = await fetchSubredditChunk(sub, allowNSFW);
      for (const it of chunk){
        if (!loadedIds.has(it.id)){ loadedIds.add(it.id); newItems.push(it); }
      }
    }catch(e){ /* ignore individual sub errors */ }
  }

  if (!newItems.length){ $("#empty").style.display="block"; }
  else {
    renderCards(newItems);
    loaded += newItems.length; total += newItems.length;
    updateCount();
  }
  $("#loadMoreBtn").disabled = false;
}

function updateCount(){ $("#count").textContent = `${loaded}/${total}` }

/* ---------------------- Render & Interactions ---------------------- */
const grid = $("#grid");

function renderCards(items){
  const frag = document.createDocumentFragment();
  for (const it of items){
    const card = h("article","card");
    card.dataset.id = it.id;

    const fig = h("figure");
    const img = new Image();
    img.loading="lazy";
    img.src = it.img;
    fig.appendChild(img);

    const ovLike = h("div","overlay");        // green tint
    const ovNo   = h("div","overlay no");     // red tint
    fig.appendChild(ovLike); fig.appendChild(ovNo);

    const content = h("div","content");
    const title = h("h3","title"); title.textContent = it.title;
    const meta = h("p","meta"); meta.textContent = `by u/${it.author} • r/${it.sub}`;
    const badges = h("div","badges");
    const b1 = h("span","badge"); b1.textContent="Reddit";
    const b2 = h("span","badge"); b2.textContent = it.nsfw ? "NSFW" : "SFW";
    badges.append(b1,b2);

    const actions = h("div","actions");
    const dismissBtn = h("button","iconbtn"); dismissBtn.innerHTML = svgX();
    const likeBtn = h("button","iconbtn"); likeBtn.innerHTML = svgStar();
    actions.append(dismissBtn, likeBtn);

    content.append(title, meta, badges);
    card.append(fig, content, actions);

    // click buttons
    likeBtn.addEventListener("click", ()=> likeCard(card, it));
    dismissBtn.addEventListener("click", ()=> dismissCard(card));

    // swipe interactions
    enableSwipe(card, ovLike, ovNo, () => likeCard(card, it), () => dismissCard(card));

    frag.appendChild(card);
  }
  grid.appendChild(frag);
}

/* swipe with pointer events + transform */
function enableSwipe(card, ovLike, ovNo, onLike, onDismiss){
  let sx=0, sy=0, dx=0, dy=0, dragging=false;

  const start = (e)=>{
    dragging=true; card.classList.add("swiping");
    const p = point(e); sx=p.x; sy=p.y; dx=0; dy=0;
  };
  const move = (e)=>{
    if(!dragging) return;
    const p=point(e); dx=p.x-sx; dy=p.y-sy;
    card.style.transform = `translate(${dx}px, ${dy*0.15}px) rotate(${dx*0.03}deg)`;
    const pct = Math.min(1, Math.abs(dx)/120);
    ovLike.style.opacity = dx>0 ? pct : 0;
    ovNo.style.opacity    = dx<0 ? pct : 0;
  };
  const end = ()=>{
    if(!dragging) return; dragging=false; card.classList.remove("swiping");
    ovLike.style.opacity = 0; ovNo.style.opacity=0;

    const threshold = 110;
    if (dx > threshold) onLike();
    else if (dx < -threshold) onDismiss();
    else { card.style.transform=""; }
  };

  card.addEventListener("pointerdown", start);
  window.addEventListener("pointermove", move);
  window.addEventListener("pointerup", end);
  // stop page scroll while dragging
  card.addEventListener("touchmove", (e)=>{ if(card.classList.contains("swiping")) e.preventDefault(); }, {passive:false});
}

function point(e){ return { x: e.clientX ?? (e.touches?.[0]?.clientX || 0), y: e.clientY ?? (e.touches?.[0]?.clientY || 0) } }

/* Like / Dismiss behaviors with animation */
function likeCard(card, item){
  // confetti hearts
  const conf = h("div","confetti"); card.appendChild(conf);
  for (let i=0;i<12;i++){
    const dot = h("i");
    const spread = 80 + Math.random()*40;
    dot.style.setProperty("--x", "0px");
    dot.style.setProperty("--y", "0px");
    dot.style.setProperty("--xend", (Math.random()*2-1)*spread+"px");
    dot.style.setProperty("--yend", -(40+Math.random()*100)+"px");
    dot.style.left = "50%"; dot.style.bottom = "16%";
    conf.appendChild(dot);
  }
  card.classList.add("like-anim");
  addLike(item);
  disappear(card);
}

function dismissCard(card){
  card.classList.add("dismiss-anim");
  // quick red flash overlay already handled during drag; just remove
  disappear(card);
}

function disappear(card){
  card.style.transition = "transform .22s ease, opacity .22s ease";
  card.style.transform = "translateY(12px) scale(.98)";
  card.style.opacity = "0";
  setTimeout(()=>{ card.remove(); }, 220);
}

/* ---------------------- SVG icons ---------------------- */
function svgStar(){ return `
<svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2">
  <path d="M12 3.5 14.9 9l6 .9-4.4 4.3 1 6-5.5-2.9-5.5 2.9 1-6L3 9.9l6-.9L12 3.5z" fill="currentColor" />
</svg>`}
function svgX(){ return `
<svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2">
  <path d="M18 6 6 18M6 6l12 12"/>
</svg>`}

/* ---------------------- Wire up ---------------------- */
$("#loadMoreBtn").addEventListener("click", loadMore);
updateCount();
</script>
</body>
</html>